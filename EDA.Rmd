---
title: "EDA Report"
author: "Suheng Yao"
date: "2024-11-15"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(tidyr)
```

# Read in the dataset
```{r}
library(dplyr)
library(ggplot2)
df_score <- read.csv("diversity_score.csv")
df <- read.csv("final_data.csv")
```


#Part 1: Max and Min minutes of awake time for each orangutans.
```{r}
#select the max and min awake minutes by names
awake <- d %>%
  group_by(Name) %>%
  summarise(
    max_minutes_awake = max(`Minutes awake`, na.rm = TRUE),
    min_minutes_awake = min(`Minutes awake`, na.rm = TRUE)
  )
print(awake)

# visualization
ggplot(awake, aes(x = Name)) +
  geom_segment(aes(xend = Name, y = min_minutes_awake, yend = max_minutes_awake), color = "gray") +
  geom_point(aes(y = max_minutes_awake, color = "Max Minutes Awake"), size = 3) +
  geom_point(aes(y = min_minutes_awake, color = "Min Minutes Awake"), size = 3) +
  scale_color_manual(values = c("Max Minutes Awake" = "skyblue", "Min Minutes Awake" = "#F3A683")) +
  theme_minimal() +
  labs(
    title = "Max and Min Minutes Awake for Each Orangutan",
    x = "Orangutan Name",
    y = "Minutes Awake",
    color = "Legend"
  ) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 2),
    plot.title = element_text(size = 14),
    axis.title = element_text(size = 12)
  ) +
  coord_cartesian(clip = "off") 
```


#Part 2: Visualization of diversity score
```{r}
# Boxplot
ggplot(dive_d, aes(x = factor(Age), y = DiversityScore)) +
  geom_boxplot(fill = "skyblue", color = "#6495ED", outlier.colour = "red", outlier.size = 3, alpha=0.7) +
  labs(
    title = "Boxplot of DiversityScore by Age",
    x = "Age",
    y = "DiversityScore"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12), axis.title = element_text(size = 14))


# Violinplot
ggplot(dive_d, aes(x = factor(Age), y = DiversityScore)) +
  geom_violin(fill = "#F3A683", color = "#E67F00", alpha=0.7) +
  labs(
    title = "Violinplot of DiversityScore by Age",
    x = "Age",
    y = "DiversityScore"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 12), axis.title = element_text(size = 14))
```
The boxplot shows that the median of Diversity Score increases slightly with Age, especially from Age group 1 to Age group 2. Then the trend leveled off and the median for all age groups remained at about 1.5. There are two outliers which appeared in Age 3 and Age 5 groups.

In the violinplot, the similar width of the violin illustrates that the sample size is relatively balanced across age groups due to, there is no particularly small or large sample group.

It also shows that the Diversity Score for all age groups was roughly distributed between 0 and 3. Most observations are concentrated between 1 and 2. The distribution shape showed bimodal characteristics, especially in Age 1 group. The data in Age 1 group were dispersed to a large extent, and the "waist" of the violin plot showed obvious bimodal distribution.

In addition, as the Age get older, the variability of the data seems to decrease and the distribution becomes more concentrated. 

Part 3
```{r}
#eda 3
diversity_stats <- df_score %>%
  group_by(Age) %>%
  summarise(
    Min = min(DiversityScore, na.rm = TRUE),
    Max = max(DiversityScore, na.rm = TRUE),
    Median = median(DiversityScore, na.rm = TRUE),
    Mean = mean(DiversityScore, na.rm = TRUE),
    SD = sd(DiversityScore, na.rm = TRUE) # Standard deviation
  )

# Print the summary statistics
print(diversity_stats)
age_counts <- df_score %>%
  group_by(Age) %>%
  summarise(count = n())
# Print the counts to the console
print(age_counts)

# Create a bar plot for the count of observations by age
ggplot(age_counts, aes(x = as.factor(Age), y = count)) +
  geom_bar(stat = "identity", fill = "lightgreen", alpha = 0.8) + # Bar plot
  labs(
    title = "Count of Observations by Age",
    x = "Age Group",
    y = "Number of Observations"
  ) +
  theme_minimal()
```

The number of observations varies significantly across age groups.
Age group 7 has the largest number of observations(about 800), which might introduce a sampling bias in the data analysis.
Age group 1 has the smallest count(about 180), which could affect the reliability of statistical summaries or models for that group.

# Part 4: ANOVA Table Analysis
## Step 1: Check for Normality of Diversity Score

```{r, warning=FALSE}
ggplot(df_score, aes(x = DiversityScore)) +
  geom_histogram(aes(y = after_stat(density)), bins = 30, fill = "lightblue", color = "black") +
  stat_function(fun = dnorm, args = list(mean = mean(df_score$DiversityScore, na.rm = TRUE), 
                                         sd = sd(df_score$DiversityScore, na.rm = TRUE)),
                color = "red", size = 1) +
  labs(title = "Histogram of DiversityScore with Normal Curve",
       x = "DiversityScore",
       y = "Density")

```
Since as shown in the histogram above, the diversity score follows a close to normal distribution, we can proceed to use ANOVA table to analyze the relationship between diversity score and age.

```{r}
anova_result <- aov(DiversityScore ~ Age, data = df_score)
summary(anova_result)
```
From the ANOVA table result, since p-value of f-test is less than 0.05, we can reject the null hypothesis, saying that there is statistically significant difference for diversity score between different age groups.



Part 5
```{r}
#eda 5
final_data_df<-read.csv("final_data.csv")
total_minutes_awake <- final_data_df %>%
  group_by(Age) %>%
  summarise(total_minutes_awake = sum(Minutes.awake, na.rm = TRUE)) # Sum of minutes awake

# Print the total minutes awake for each age
print(total_minutes_awake)

average_minutes_awake <- final_data_df %>%
  group_by(Age) %>%
  summarise(
    total_minutes_awake = sum(Minutes.awake, na.rm = TRUE), # Total minutes awake
    age_count = n() # Count of observations per age
  ) %>%
  mutate(avg_minutes_awake = total_minutes_awake / age_count)
print(average_minutes_awake)
str(average_minutes_awake)
# Create a bar plot to show the distribution of total minutes awake by age
ggplot(average_minutes_awake, aes(x = factor(Age), y = avg_minutes_awake)) +
  geom_bar(stat = "identity", fill = "steelblue", alpha = 0.8) + # Bar plot
  labs(
    title = "Average Minutes Awake by Age Group",
    x = "Age Group",
    y = "Average Minutes Awake"
  ) +
  theme_minimal() +
  theme( ) 
```

The average minutes awake is relatively consistent across all age groups, hovering around 630â€“660 minutes.
There is no significant increase or decrease in the average minutes awake as age increases, suggesting that wakefulness may not be strongly age-dependent within this dataset.

# Part 6: Find the Number of Unique Positional Behaviors for Each Age Group
```{r}
result <- df %>%
  pivot_longer(cols = 7:ncol(df),
               names_to = "Behavior", 
               values_to = "Value") %>%
  filter(Value != 0.0)

result <- result %>%
  group_by(Age) %>%
  summarise(PB_count = n_distinct(Behavior)) %>%
  arrange(desc(PB_count))

ggplot(result, aes(x=Age, y=PB_count)) +
  geom_line() +
  geom_point(color = "blue", size = 3) +
  theme_minimal()

print(result)
```
From the table above, Age 4 group has 68 kinds of positional behaviors, which is the most number of distinct positional behaviors across all age groups. Age 1 group has only 49 kinds of positional behaviors, which is the least number of distinct behaviour among 7 groups.

Also, from the line graph, starting from age 2 to 4, there is a surge in the number of distinct positional behaviors, and after year 4, there is a significant decrease in number of positional behaviors, which means that year 4 is an important time point to focus on.
