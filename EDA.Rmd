---
title: "EDA Report"
author: "Suheng Yao"
date: "2024-11-15"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(tidyr)
```

# Read in the dataset
```{r}
df_score <- read.csv("diversity_score.csv")
df <- read.csv("final_data.csv")
```
# Part 4: ANOVA Table Analysis
## Step 1: Check for Normality of Diversity Score

```{r, warning=FALSE}
ggplot(df_score, aes(x = DiversityScore)) +
  geom_histogram(aes(y = after_stat(density)), bins = 30, fill = "lightblue", color = "black") +
  stat_function(fun = dnorm, args = list(mean = mean(df_score$DiversityScore, na.rm = TRUE), 
                                         sd = sd(df_score$DiversityScore, na.rm = TRUE)),
                color = "red", size = 1) +
  labs(title = "Histogram of DiversityScore with Normal Curve",
       x = "DiversityScore",
       y = "Density")

```
Since as shown in the histogram above, the diversity score follows a close to normal distribution, we can proceed to use ANOVA table to analyze the relationship between diversity score and age.

```{r}
anova_result <- aov(DiversityScore ~ Age, data = df_score)
summary(anova_result)
```
From the ANOVA table result, since p-value of f-test is less than 0.05, we can reject the null hypothesis, saying that there is statistically significant difference for diversity score between different age groups.

# Part 6: Find the Number of Unique Positional Behaviors for Each Age Group
```{r}
result <- df %>%
  pivot_longer(cols = 7:ncol(df),
               names_to = "Behavior", 
               values_to = "Value") %>%
  filter(Value != 0.0)

result <- result %>%
  group_by(Age) %>%
  summarise(PB_count = n_distinct(Behavior)) %>%
  arrange(desc(PB_count))

ggplot(result, aes(x=Age, y=PB_count)) +
  geom_line() +
  geom_point(color = "blue", size = 3) +
  theme_minimal()

print(result)
```
From the table above, Age 4 group has 68 kinds of positional behaviors, which is the most number of distinct positional behaviors across all age groups. Age 1 group has only 49 kinds of positional behaviors, which is the least number of distinct behaviour among 7 groups.

Also, from the line graph, starting from age 2 to 4, there is a surge in the number of kinds of positional behaviors, and after year 4, there is a significant decrease in number of positional behaviors, which means that year 4 is an important time point to focus on.
